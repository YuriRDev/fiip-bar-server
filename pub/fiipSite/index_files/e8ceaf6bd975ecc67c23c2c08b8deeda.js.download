/**handles:sb-main-js**/
"use strict";!function(e,t){if("function"==typeof define&&define.amd)define(["exports","module"],t);else if("undefined"!=typeof exports&&"undefined"!=typeof module)t(exports,module);else{var i={exports:{}};t(i.exports,i),e.autosize=i.exports}}(this,function(e,t){function i(e){function t(){var t=window.getComputedStyle(e,null);f=t.overflowY,"vertical"===t.resize?e.style.resize="none":"both"===t.resize&&(e.style.resize="horizontal"),d="content-box"===t.boxSizing?-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)):parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth),isNaN(d)&&(d=0),o()}function i(t){var i=e.style.width;e.style.width="0px",e.offsetWidth,e.style.width=i,f=t,u&&(e.style.overflowY=t),n()}function n(){var t=window.pageYOffset,i=document.body.scrollTop,n=e.style.height;e.style.height="auto";var o=e.scrollHeight+d;return 0===e.scrollHeight?void(e.style.height=n):(e.style.height=o+"px",h=e.clientWidth,document.documentElement.scrollTop=t,void(document.body.scrollTop=i))}function o(){var t=e.style.height;n();var o=window.getComputedStyle(e,null);if(o.height!==e.style.height?"visible"!==f&&i("visible"):"hidden"!==f&&i("hidden"),t!==e.style.height){var r=document.createEvent("Event");r.initEvent("autosize:resized",!0,!1),e.dispatchEvent(r)}}var s=void 0===arguments[1]?{}:arguments[1],a=s.setOverflowX,c=void 0===a||a,l=s.setOverflowY,u=void 0===l||l;if(e&&e.nodeName&&"TEXTAREA"===e.nodeName&&!r.has(e)){var d=null,f=null,h=e.clientWidth,p=function(){e.clientWidth!==h&&o()},b=function(t){window.removeEventListener("resize",p,!1),e.removeEventListener("input",o,!1),e.removeEventListener("keyup",o,!1),e.removeEventListener("autosize:destroy",b,!1),e.removeEventListener("autosize:update",o,!1),r.delete(e),Object.keys(t).forEach(function(i){e.style[i]=t[i]})}.bind(e,{height:e.style.height,resize:e.style.resize,overflowY:e.style.overflowY,overflowX:e.style.overflowX,wordWrap:e.style.wordWrap});e.addEventListener("autosize:destroy",b,!1),"onpropertychange"in e&&"oninput"in e&&e.addEventListener("keyup",o,!1),window.addEventListener("resize",p,!1),e.addEventListener("input",o,!1),e.addEventListener("autosize:update",o,!1),r.add(e),c&&(e.style.overflowX="hidden",e.style.wordWrap="break-word"),t()}}function n(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName){var t=document.createEvent("Event");t.initEvent("autosize:destroy",!0,!1),e.dispatchEvent(t)}}function o(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName){var t=document.createEvent("Event");t.initEvent("autosize:update",!0,!1),e.dispatchEvent(t)}}var r="function"==typeof Set?new Set:function(){var e=[];return{has:function(t){return Boolean(e.indexOf(t)>-1)},add:function(t){e.push(t)},delete:function(t){e.splice(e.indexOf(t),1)}}}(),s=null;"undefined"==typeof window||"function"!=typeof window.getComputedStyle?(s=function(e){return e},s.destroy=function(e){return e},s.update=function(e){return e}):(s=function(e,t){return e&&Array.prototype.forEach.call(e.length?e:[e],function(e){return i(e,t)}),e},s.destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],n),e},s.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],o),e}),t.exports=s}),!function(e){e.fn.extend({slimScroll:function(i){var n={width:"auto",height:"300px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:1,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},o=e.extend(n,i);return this.each(function(){function n(t){if(u){var t=t||window.event,i=0;t.wheelDelta&&(i=-t.wheelDelta/120),t.detail&&(i=t.detail/3);var n=t.target||t.srcTarget||t.srcElement;e(n).closest("."+o.wrapperClass).is(_.parent())&&r(i,!0),t.preventDefault&&!w&&t.preventDefault(),w||(t.returnValue=!1)}}function r(e,t,i){w=!1;var n=e,r=_.outerHeight()-E.outerHeight();if(t&&(n=parseInt(E.css("top"))+e*parseInt(o.wheelStep)/100*E.outerHeight(),n=Math.min(Math.max(n,0),r),n=e>0?Math.ceil(n):Math.floor(n),E.css({top:n+"px"})),g=parseInt(E.css("top"))/(_.outerHeight()-E.outerHeight()),n=g*(_[0].scrollHeight-_.outerHeight()),i){n=e;var s=n/_[0].scrollHeight*_.outerHeight();s=Math.min(Math.max(s,0),r),E.css({top:s+"px"})}_.scrollTop(n),_.trigger("slimscrolling",~~n),c(),l()}function s(e){window.addEventListener?(e.addEventListener("DOMMouseScroll",n,!1),e.addEventListener("mousewheel",n,!1)):document.attachEvent("onmousewheel",n)}function a(){b=Math.max(_.outerHeight()/_[0].scrollHeight*_.outerHeight(),y),E.css({height:b+"px"});var e=b==_.outerHeight()?"none":"block";E.css({display:e})}function c(){if(a(),clearTimeout(h),g==~~g){if(w=o.allowPageScroll,v!=g){var e=0==~~g?"top":"bottom";_.trigger("slimscroll",e)}}else w=!1;return v=g,b>=_.outerHeight()?void(w=!0):(E.stop(!0,!0).fadeIn("fast"),void(o.railVisible&&S.stop(!0,!0).fadeIn("fast")))}function l(){o.alwaysVisible||(h=setTimeout(function(){o.disableFadeOut&&u||d||f||(E.fadeOut("slow"),S.fadeOut("slow"))},1e3))}var u,d,f,h,p,b,g,v,m="<div></div>",y=30,w=!1,_=e(this);if(_.parent().hasClass(o.wrapperClass)){var x=_.scrollTop();if(E=_.siblings("."+o.barClass),S=_.siblings("."+o.railClass),a(),e.isPlainObject(i)){if("height"in i&&"auto"==i.height){_.parent().css("height","auto"),_.css("height","auto");var k=_.parent().parent().height();_.parent().css("height",k),_.css("height",k)}else if("height"in i){var O=i.height;_.parent().css("height",O),_.css("height",O)}if("scrollTo"in i)x=parseInt(o.scrollTo);else if("scrollBy"in i)x+=parseInt(o.scrollBy);else if("destroy"in i)return E.remove(),S.remove(),void _.unwrap();r(x,!1,!0)}}else if(!(e.isPlainObject(i)&&"destroy"in i)){o.height="auto"==o.height?_.parent().height():o.height;var j=e(m).addClass(o.wrapperClass).css({position:"relative",overflow:"hidden",width:o.width,height:o.height});_.css({overflow:"hidden",width:o.width,height:o.height});var S=e(m).addClass(o.railClass).css({width:o.size,height:"100%",position:"absolute",top:0,display:o.alwaysVisible&&o.railVisible?"block":"none","border-radius":o.railBorderRadius,background:o.railColor,opacity:o.railOpacity,zIndex:90}),E=e(m).addClass(o.barClass).css({background:o.color,width:o.size,position:"absolute",top:0,opacity:o.opacity,display:o.alwaysVisible?"block":"none","border-radius":o.borderRadius,BorderRadius:o.borderRadius,MozBorderRadius:o.borderRadius,WebkitBorderRadius:o.borderRadius,zIndex:99}),P="right"==o.position?{right:o.distance}:{left:o.distance};S.css(P),E.css(P),_.wrap(j),_.parent().append(E),_.parent().append(S),o.railDraggable&&E.bind("mousedown",function(i){var n=e(document);return f=!0,t=parseFloat(E.css("top")),pageY=i.pageY,n.bind("mousemove.slimscroll",function(e){currTop=t+e.pageY-pageY,E.css("top",currTop),r(0,E.position().top,!1)}),n.bind("mouseup.slimscroll",function(e){f=!1,l(),n.unbind(".slimscroll")}),!1}).bind("selectstart.slimscroll",function(e){return e.stopPropagation(),e.preventDefault(),!1}),S.hover(function(){c()},function(){l()}),E.hover(function(){d=!0},function(){d=!1}),_.hover(function(){u=!0,c(),l()},function(){u=!1,l()}),_.bind("touchstart",function(e,t){e.originalEvent.touches.length&&(p=e.originalEvent.touches[0].pageY)}),_.bind("touchmove",function(e){if(w||e.originalEvent.preventDefault(),e.originalEvent.touches.length){var t=(p-e.originalEvent.touches[0].pageY)/o.touchScrollStep;r(t,!0),p=e.originalEvent.touches[0].pageY}}),a(),"bottom"===o.start?(E.css({top:_.outerHeight()-E.outerHeight()}),r(0,!0)):"top"!==o.start&&(r(e(o.start).position().top,null,!0),o.alwaysVisible||E.hide()),s(this)}}),this}}),e.fn.extend({slimscroll:e.fn.slimScroll})}(jQuery),!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Push=e()}(function(){return function e(t,i,n){function o(s,a){if(!i[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(r)return r(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[s]={exports:{}};t[s][0].call(u.exports,function(e){var i=t[s][1][e];return o(i||e)},u,u.exports,e,t,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default={errors:{incompatible:"PushError: Push.js is incompatible with browser.",invalid_plugin:"PushError: plugin class missing from plugin manifest (invalid plugin). Please check the documentation.",invalid_title:"PushError: title of notification must be a string",permission_denied:"PushError: permission request declined",sw_notification_error:"PushError: could not show a ServiceWorker notification due to the following reason: ",sw_registration_error:"PushError: could not register the ServiceWorker due to the following reason: ",unknown_interface:"PushError: unable to create notification: unknown interface"}}},{}],2:[function(e,t,i){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(t){n(this,e),this._win=t,this.DEFAULT="default",this.GRANTED="granted",this.DENIED="denied",this._permissions=[this.GRANTED,this.DEFAULT,this.DENIED]}return o(e,[{key:"request",value:function(e,t){var i=this,n=this.get(),o=function(n){n===i.GRANTED||0===n?e&&e():t&&t()};n!==this.DEFAULT?o(n):this._win.Notification&&this._win.Notification.requestPermission?this._win.Notification.requestPermission().then(o).catch(function(){t&&t()}):this._win.webkitNotifications&&this._win.webkitNotifications.checkPermission?this._win.webkitNotifications.requestPermission(o):e&&e()}},{key:"has",value:function(){return this.get()===this.GRANTED}},{key:"get",value:function(){return this._win.Notification&&this._win.Notification.permission?this._win.Notification.permission:this._win.webkitNotifications&&this._win.webkitNotifications.checkPermission?this._permissions[this._win.webkitNotifications.checkPermission()]:navigator.mozNotification?this.GRANTED:this._win.external&&this._win.external.msIsSiteMode?this._win.external.msIsSiteMode()?this.GRANTED:this.DEFAULT:this.GRANTED}}]),e}();i.default=r},{}],3:[function(e,t,i){function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=n(e("./Messages")),a=n(e("./Permission")),c=n(e("./Util")),l=n(e("./agents/DesktopAgent")),u=n(e("./agents/MobileChromeAgent")),d=n(e("./agents/MobileFirefoxAgent")),f=n(e("./agents/MSAgent")),h=n(e("./agents/WebKitAgent")),p=function(){function e(t){o(this,e),this._currentId=0,this._notifications={},this._win=t,this.Permission=new a.default(t),this._agents={desktop:new l.default(t),chrome:new u.default(t),firefox:new d.default(t),ms:new f.default(t),webkit:new h.default(t)},this._configuration={serviceWorker:"/serviceWorker.min.js",fallback:function(e){}}}return r(e,[{key:"_closeNotification",value:function(e){var t=!0,i=this._notifications[e];if(void 0!==i){if(t=this._removeNotification(e),this._agents.desktop.isSupported())this._agents.desktop.close(i);else if(this._agents.webkit.isSupported())this._agents.webkit.close(i);else{if(!this._agents.ms.isSupported())throw t=!1,new Error(s.default.errors.unknown_interface);this._agents.ms.close()}return t}return!1}},{key:"_addNotification",value:function(e){var t=this._currentId;return this._notifications[t]=e,this._currentId++,t}},{key:"_removeNotification",value:function(e){var t=!1;return this._notifications.hasOwnProperty(e)&&(delete this._notifications[e],t=!0),t}},{key:"_prepareNotification",value:function(e,t){var i=this,n=void 0;return n={get:function(){return i._notifications[e]},close:function(){i._closeNotification(e)}},t.timeout&&setTimeout(function(){n.close()},t.timeout),n}},{key:"_serviceWorkerCallback",value:function(e,t,i){var n=this,o=this._addNotification(e[e.length-1]);navigator.serviceWorker.addEventListener("message",function(e){var t=JSON.parse(e.data);"close"===t.action&&Number.isInteger(t.id)&&n._removeNotification(t.id)}),i(this._prepareNotification(o,t))}},{key:"_createCallback",value:function(e,t,i){var n=this,o=void 0,r=null;if(t=t||{},o=function(e){n._removeNotification(e),c.default.isFunction(t.onClose)&&t.onClose.call(n,r)},this._agents.desktop.isSupported())try{r=this._agents.desktop.create(e,t)}catch(o){var s=this._currentId,a=this.config().serviceWorker,l=function(e){return n._serviceWorkerCallback(e,t,i)};this._agents.chrome.isSupported()&&this._agents.chrome.create(s,e,t,a,l)}else this._agents.webkit.isSupported()?r=this._agents.webkit.create(e,t):this._agents.firefox.isSupported()?this._agents.firefox.create(e,t):this._agents.ms.isSupported()?r=this._agents.ms.create(e,t):(t.title=e,this.config().fallback(t));if(null!==r){var u=this._addNotification(r),d=this._prepareNotification(u,t);c.default.isFunction(t.onShow)&&r.addEventListener("show",t.onShow),c.default.isFunction(t.onError)&&r.addEventListener("error",t.onError),c.default.isFunction(t.onClick)&&r.addEventListener("click",t.onClick),r.addEventListener("close",function(){o(u)}),r.addEventListener("cancel",function(){o(u)}),i(d)}i(null)}},{key:"create",value:function(e,t){var i=this,n=void 0;if(!c.default.isString(e))throw new Error(s.default.errors.invalid_title);return n=this.Permission.has()?function(n,o){try{i._createCallback(e,t,n)}catch(e){o(e)}}:function(n,o){i.Permission.request(function(){try{i._createCallback(e,t,n)}catch(e){o(e)}},function(){o(s.default.errors.permission_denied)})},new Promise(n)}},{key:"count",value:function(){var e=void 0,t=0;for(e in this._notifications)this._notifications.hasOwnProperty(e)&&t++;return t}},{key:"close",value:function(e){var t=void 0;for(t in this._notifications)if(this._notifications.hasOwnProperty(t)&&this._notifications[t].tag===e)return this._closeNotification(t)}},{key:"clear",value:function(){var e=void 0,t=!0;for(e in this._notifications)this._notifications.hasOwnProperty(e)&&(t=t&&this._closeNotification(e));return t}},{key:"supported",value:function(){var e=!1;for(var t in this._agents)this._agents.hasOwnProperty(t)&&(e=e||this._agents[t].isSupported());return e}},{key:"config",value:function(e){return(void 0!==e||null!==e&&c.default.isObject(e))&&c.default.objectMerge(this._configuration,e),this._configuration}},{key:"extend",value:function(e){var t,i={}.hasOwnProperty;if(!i.call(e,"plugin"))throw new Error(s.default.errors.invalid_plugin);i.call(e,"config")&&c.default.isObject(e.config)&&null!==e.config&&this.config(e.config),t=new(0,e.plugin)(this.config());for(var n in t)i.call(t,n)&&c.default.isFunction(t[n])&&(this[n]=t[n])}}]),e}();i.default=p},{"./Messages":1,"./Permission":2,"./Util":4,"./agents/DesktopAgent":6,"./agents/MSAgent":7,"./agents/MobileChromeAgent":8,"./agents/MobileFirefoxAgent":9,"./agents/WebKitAgent":10}],4:[function(e,t,i){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=function(){function e(){n(this,e)}return r(e,null,[{key:"isUndefined",value:function(e){return void 0===e}},{key:"isString",value:function(e){return"string"==typeof e}},{key:"isFunction",value:function(e){return e&&"[object Function]"==={}.toString.call(e)}},{key:"isObject",value:function(e){return"object"==(void 0===e?"undefined":o(e))}},{key:"objectMerge",value:function(e,t){for(var i in t)e.hasOwnProperty(i)&&this.isObject(e[i])&&this.isObject(t[i])?this.objectMerge(e[i],t[i]):e[i]=t[i]}}]),e}();i.default=s},{}],5:[function(e,t,i){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.default=function e(t){n(this,e),this._win=t}},{}],6:[function(e,t,i){function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=n(e("./AbstractAgent")),l=n(e("../Util")),u=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,c.default),a(t,[{key:"isSupported",value:function(){return void 0!==this._win.Notification}},{key:"create",value:function(e,t){return new this._win.Notification(e,{icon:l.default.isString(t.icon)||l.default.isUndefined(t.icon)?t.icon:t.icon.x32,body:t.body,tag:t.tag,requireInteraction:t.requireInteraction})}},{key:"close",value:function(e){e.close()}}]),t}();i.default=u},{"../Util":4,"./AbstractAgent":5}],7:[function(e,t,i){function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=n(e("./AbstractAgent")),l=n(e("../Util")),u=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,c.default),a(t,[{key:"isSupported",value:function(){return void 0!==this._win.external&&void 0!==this._win.external.msIsSiteMode}},{key:"create",value:function(e,t){return this._win.external.msSiteModeClearIconOverlay(),this._win.external.msSiteModeSetIconOverlay(l.default.isString(t.icon)||l.default.isUndefined(t.icon)?t.icon:t.icon.x16,e),this._win.external.msSiteModeActivate(),null}},{key:"close",value:function(){this._win.external.msSiteModeClearIconOverlay()}}]),t}();i.default=u},{"../Util":4,"./AbstractAgent":5}],8:[function(e,t,i){function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=n(e("./AbstractAgent")),l=n(e("../Util")),u=n(e("../Messages")),d=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,c.default),a(t,[{key:"isSupported",value:function(){return void 0!==this._win.navigator&&void 0!==this._win.navigator.serviceWorker}},{key:"getFunctionBody",value:function(e){return e.toString().match(/function[^{]+{([\s\S]*)}$/)[1]}},{key:"create",value:function(e,t,i,n,o){var r=this;this._win.navigator.serviceWorker.register(n),this._win.navigator.serviceWorker.ready.then(function(n){var s={id:e,link:i.link,origin:document.location.href,onClick:l.default.isFunction(i.onClick)?r.getFunctionBody(i.onClick):"",onClose:l.default.isFunction(i.onClose)?r.getFunctionBody(i.onClose):""};void 0!==i.data&&null!==i.data&&(s=Object.assign(s,i.data)),n.showNotification(t,{icon:i.icon,body:i.body,vibrate:i.vibrate,tag:i.tag,data:s,requireInteraction:i.requireInteraction,silent:i.silent}).then(function(){n.getNotifications().then(function(e){n.active.postMessage(""),o(e)})}).catch(function(e){throw new Error(u.default.errors.sw_notification_error+e.message)})}).catch(function(e){throw new Error(u.default.errors.sw_registration_error+e.message)})}},{key:"close",value:function(){}}]),t}();i.default=d},{"../Messages":1,"../Util":4,"./AbstractAgent":5}],9:[function(e,t,i){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(e("./AbstractAgent")),c=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,a.default),s(t,[{key:"isSupported",value:function(){return void 0!==this._win.navigator.mozNotification}},{key:"create",value:function(e,t){var i=this._win.navigator.mozNotification.createNotification(e,t.body,t.icon);return i.show(),i}}]),t}();i.default=c},{"./AbstractAgent":5}],10:[function(e,t,i){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(e("./AbstractAgent")),c=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,a.default),s(t,[{key:"isSupported",value:function(){return void 0!==this._win.webkitNotifications}},{key:"create",value:function(e,t){var i=this._win.webkitNotifications.createNotification(t.icon,e,t.body);return i.show(),i}},{key:"close",value:function(e){e.cancel()}}]),t}();i.default=c},{"./AbstractAgent":5}],11:[function(e,t,i){var n=function(e){return e&&e.__esModule?e:{default:e}}(e("./classes/Push"));t.exports=new n.default("undefined"!=typeof window?window:void 0)},{"./classes/Push":3}]},{},[11])(11)}),function(e){function t(t){e(".sb-progress-bar").css("width","0%"),e(".sb-progress").show();for(var n=0;n<t.length;n++){var o=t[n],r=new FormData;r.append("file",o),r.append("user_id",O.id),r.append("type","attachments"),jQuery.ajax({url:Z+(te?"/php/upload.php":"/include/upload.php"),cache:!1,contentType:!1,processData:!1,data:r,type:"post",success:function(e){},xhr:function(){var e=jQuery.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",i,!1),e}})}}function i(t){if(t.lengthComputable){var i=t.total,n=t.loaded,o=100*n/i;e(".sb-progress-bar").css("width",o+"%"),o>=100&&(r(),e("#status-completed").show(),e(".sb-progress").hide(),e(".sb-clear-msg").hide())}}function n(t){e(".sb-progress-bar").css("width","0%"),e(".sb-progress").show();var i=new FormData;i.append("file",t[0]),i.append("user_id",j),i.append("type","profile"),jQuery.ajax({url:Z+(te?"/php/upload.php":"/include/upload-profile.php"),dataType:"image",cache:!1,contentType:!1,processData:!1,data:i,type:"post",success:function(e){},xhr:function(){var e=jQuery.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",o,!1),e}})}function o(t){if(t.lengthComputable){var i=t.total,n=t.loaded,o=100*n/i;if(e(".sb-progress-bar").css("width",o+"%"),o>=100){var r=(te?Z+"/php/uploads/":sb_wp_url+"/wp-content/uploads/supportboard/")+j+"/"+j+".jpg";setTimeout(function(){e(".sb-input-reg-img img").attr("src",r)},300),e(".sb-progress").hide()}}}function r(){var t=S,i=e(t).find(".sb-editor textarea"),n=e(i).val(),o=e(t).find(".sb-editor .sb-upload-files").prop("files"),r=new Date,s="",a="",l=!1;if(v(o)&&(o=""),o.length>0){s='<div class="sb-files">';for(var h=0;h<o.length;h++){var b=o[h].name,g=b.substring(b.lastIndexOf(".")+1);if(e.inArray(g,k)>-1){var m=(te?Z+"/php/uploads/":sb_wp_url+"/wp-content/uploads/supportboard/")+O.id+"/"+o[h].name;s+=_(o[h].name,m),a+=m+"|"+o[h].name+"?"}else l=!0}s+="</div>",a=a.substring(0,a.length-1)}if(""!=n&&(n=e.trim(n)),n.length>0||""!=a){e(t).find(".sb-editor .sb-loader").show(),n=d(n);var y=e(t).find(".sb-list,.sb-chat-list");setTimeout(function(){e(y).append('<div class="sb-card sb-card-right'+(""==n?" sb-card-no-msg":"")+'"><div class="sb-thumb"><img src="'+O.img+'" /><div>'+p(O.username)+'</div></div><div class="sb-card-cnt"><div class="sb-message">'+f(n)+"</div>"+s+'<div class="sb-time">'+r.toLocaleString()+"</div></div></div>"),u(y,E)},1e3),B=!1,jQuery.ajax({method:"POST",url:ee,data:{action:"sb_ajax_add_message",msg:n,files:a,time:r.toLocaleString(),user_id:O.id,user_img:O.img,user_name:O.username,user_type:"user",environment:te?"php":"wp",lang:ie}}).done(function(o){if(G=!0,o=o.length>5?JSON.parse(o):["error",""],"success"==o[0]||"success-bot"==o[0]){if(jQuery.ajax({method:"POST",url:ee,data:{action:"sb_send_async_email",environment:te?"php":"wp"}}).done(function(e){}),c(n,a),"success-bot"==o[0]){if(s="",a="",!v(o[1].files)&&o[1].files.length>0){s+='<div class="sb-files">';for(var r=0;r<o[1].files.length;r++)if(o[1].files[r].indexOf("|")>0){var l=o[1].files[r].split("|");s+=_(l[0],l[1]),a+=l[0]+"|"+l[1]+"?"}s+="</div>",a=a.substring(0,a.length-1)}setTimeout(function(){c(f(o[1].msg),a,{id:O.id,name:o[1].user_name,img:o[1].user_img},!0)},300)}else if(H&&!W&&E&&z&&""==O.email){var d=A+1;999999==A&&(d=1),setTimeout(function(){A==d&&(e(y).append(e("#sb-card-contacts-cnt").html()),u(y,E),W=!0)},15e3)}u(y,E),A++,x(!1)}if(e(t).find(".sb-editor .sb-loader").hide(),e(t).find(".sb-progress-bar").css("width","0%"),e(i).val("").focus(),I&&e(X).hasClass("sb-new")){if(e(X).removeClass("sb-new"),e(".sb-chat-custom-height").length){var h=e(".sb-chat-list"),p=e(h).height()+90;E&&p>300&&(p=300),e(h).slimScroll({height:p})}I=!1}})}e(i).val("").focus(),e(t).find(".sb-editor .sb-upload-files").replaceWith(e(t).find(".sb-editor .sb-upload-files").val("").clone(!0)),e(t).find(".sb-attachment-cnt .sb-attachments-list").html(""),l&&alert("Sorry, some file type is not permitted for security reasons. Insert the files into zip archive.")}function s(e){var t=new Date;jQuery.ajax({method:"POST",url:ee,data:{action:"sb_ajax_bot_message",msg:e,time:t.toLocaleString(),user_id:O.id,lang:ie}}).done(function(e){})}function a(t,i){v(i)&&(i=!!e(t).hasClass("sb-chat-list")),jQuery.ajax({method:"POST",url:ee,data:{action:"sb_ajax_read_messages"}}).done(function(n){var o=!0;if("error"!=n&&n.length>10){var r=!1,s="",a=0;try{r=JSON.parse(n)}catch(i){e(t).html("The conversation can not be processed to a JSON parser error. Please contact the support by email or phone. We are sorry for the problem."),console.log(i.message)}if(0!=r){o=!1;var c="",d={id:"",img:"",name:""};if(a=r.length,e(t).find(".sb-card:not(.sb-card-exclude)").length!=r.length){for(var h=0;h<a;h++){var m=r[h].msg;if(""!=m||!v(r[h].files)&&r[h].files.length>0){var y="agent";r[h].user_id==O.id&&(y="user");var w=b(m);if(0==w&&(w=g(m)),0!=w&&w[1])c+=w;else{var x="";if(!v(r[h].files)&&r[h].files.length>0){x+='<div class="sb-files">';for(var k=0;k<r[h].files.length;k++)if(r[h].files[k].indexOf("|")>0){var j=r[h].files[k].split("|");x+=_(j[1],j[0])}x+="</div>"}var S=r[h].time;S.indexOf("unix")>-1&&(S=new Date(parseInt(S.replace("unix","")+"000")).toLocaleString()),c+='<div class="sb-card'+("user"==y?" sb-card-right":"")+(""==m?" sb-card-no-msg":"")+'" data-user-id="'+r[h].user_id+'"><div class="sb-thumb"><img src="'+r[h].user_img+'" /><div>'+p(r[h].user_name)+'</div></div><div class="sb-card-cnt"><div class="sb-message">'+(0==w?f(m):w[0])+"</div>"+x+'<div class="sb-time">'+S+"</div></div></div>"}"agent"==y&&(d={id:r[h].user_id,img:r[h].user_img,name:r[h].user_name}),s=y}}if(e(t).html(c),D&&""!=d.id){var E=e(X).attr("data-agent"),P="";v(E)?(E="",P=" sb-only-name"):E='<div class="sb-chat-header-sub">'+E+"</div>",e(".sb-chat-header").html('<img class="sb-chat-header-img'+P+'" src="'+d.img+'" /><div class="sb-chat-header-text">'+d.name+E+"</div>").addClass("sb-chat-header-agent"),D=!1}if(M&&""==c&&e(X).addClass("sb-new"),C&&A<a&&T.play(),V||M||!U||B?V&&(B=!0):(Push.create(d.name,{body:r[a-1].msg,icon:d.img,timeout:4e3,onClick:function(){l(!1)}}),B=!0),Y&&!M){var N=document.title;clearInterval($),$=setInterval(function(){document.title=J,setTimeout(function(){document.title=N},1500)},3e3)}}}o&&e(t).find(".sb-list-msg").show(),z&&i&&M&&A>1&&"agent"==s&&"false"==re&&l(C),A<a||M?(setTimeout(function(){u(t,i)},350),M=!1):(A<a||999999==A)&&e(".sb-card").length&&e("body").animate({scrollTop:e(".sb-card").last().offset().top},1),A=a}else if(e(X).addClass("sb-new"),i){var I=e(X).attr("data-welcome");!v(I)&&F&&(R||v(localStorage.getItem("sb_first_visit")))&&setTimeout(function(){
e(t).html('<div class="sb-card sb-card-exclude" data-user-id="welcome"><div class="sb-thumb"><img src="'+e(X).attr("data-welcome-img")+'"><div></div></div><div class="sb-card-cnt"><div class="sb-message">'+I+'</div><div class="sb-time"></div></div></div>'),e(X).hasClass("welcome-closed")||"false"!=re&&0!=re||l(C);var i=new Date;localStorage.setItem("sb_first_visit",i.toLocaleString())},1e3),M=!1}else e(t).find(".sb-list-msg").show();e(".sb-chat-list-loader,.sb-list-loader").remove()})}function c(e,t,i,n){if(Q){var o,r,s;v(n)&&(n=!1),v(t)&&(t=""),v(i)?(o=O.id,r=O.img,s=O.username):(o=i.id,r=i.img,s=i.name),jQuery.ajax({method:"POST",url:ee,data:{action:"sb_ajax_slack_send_message",msg:e,files:t,user_id:o,user_img:r,user_name:s,is_bot:n}}).done(function(e){})}}function l(t){e(".sb-chat-cnt").hasClass("sb-active")||setTimeout(function(){e(".sb-chat-btn").click(),t&&T.play(),x(!1)},500)}function u(t,i){(!v(e(t).attr("data-scroll"))&&N||i)&&e(t).slimScroll({scrollTo:"99999px"})}function d(e){return v(e)?"":(e=e.replace(/(?:\r\n|\r|\n)/g,"<br />"),e=e.replace(/\/"/g,"/&#8220;"),e=e.replace(/\"/g,"&#8220;"),e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/="/g,"=&quot;"),e=e.replace(/='/g,"=&#039;"))}function f(e){if(!v(e)){var t=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,i=e.replace(t,'<a href="$1" target="_blank">$1</a>'),n=/(^|[^\/f])(www\.[\S]+(\b|$))/gim,i=i.replace(n,'$1<a href="http://$2" target="_blank">$2</a>'),o=/(\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,6})/gim,i=i.replace(o,'<a href="mailto:$1">$1</a>');return i=i.replace(/&lt;br \/&gt;/g,"<br />"),i=i.replace(/&amp;#8220;/g,'"'),i=i.replace(/&amp;#39;/g,"'"),i=i.replace(/&lt;<a/g,"<a"),i=i.replace(/&gt<\/a>;/g,"</a>"),i=i.replace(/&gt"/g,'"')}return""}function h(e){return v(e)?"":(e=e.replace(/"/g,"&#8220;"),e=e.replace(/'/g,"&#39;"))}function p(e){return v(e)?"":(e=e.replace(/&#8220;/g,"'"),e=e.replace(/&#39;/g,"'"),e=e.replace(/&gt"/g,"'"))}function b(t){var i=!1,n=!0;return"#follow"==t&&(t=e("#sb-card-contacts-cnt").html().replace("sb-card-exclude","sb-card-command"),i=!0),!!i&&[t,n]}function g(e){var t="string"!=typeof e;if(t||0==e.indexOf("{")){if(!t){e=e.replace(/&quot;/g,'"');var i=!1;try{e=JSON.parse(e)}catch(e){return!1}}if(0!=e){i=!0;var n="";if(v(e.status)||"closed"!=e.status||(n=" rich-closed "),"quick_replies"==e.type||"buttons"==e.type){var o="",r="",s="quickreplies";if("buttons"==e.type&&(s="buttons"),""!=e.text&&(r="<span>"+e.text+"</span>"),""==n)for(var a=0;a<e.replies.length;a++)o+="<div>"+e.replies[a]+"</div>";else o="<div>"+e.replies[e.status_info]+"</div>";e='<div class="rich-box '+n+"rich-"+s+'"><div class="rich-header"><div>'+e.title+"</div>"+r+'</div><div class="rich-content">'+o+"</div></div>"}}if(i)return[e,!1]}return!1}function v(e){var t=typeof e;return"undefined"===t||null===e||!(e.length>0||"object"==t&&Object.keys(e).length>0||"boolean"===t||"number"==t)||"undefined"===e}function m(e,t){return Math.floor(Math.random()*(t-e+1))+e}function y(e,t){for(var i=e.split(","),n=0;n<i.length;n++)t[i[n].split(":")[0]]=w(i[n].split(":")[1]);return t}function w(e){return"number"==typeof e?parseFloat(e):"true"==e||"false"!=e&&e}function _(e,t){var i="";if(0==e.indexOf("http")){var n=e;e=t,t=n}return i+=t.indexOf(".jpg")>0||t.indexOf(".png")>0||t.indexOf(".gif")>0?'<a class="sb-link-img" target="_blank" href="'+t+'"><img src="'+t+'" /></a>':'<a target="_blank" href="'+t+'">'+e+"</a>"}function x(e){re=e,localStorage.setItem("chat_close",e)}var k=["psd","ai","eps","pptx","rtf","wma","odp","ods","sxw","sxi","sxc","dwg","xps","jpg","jpeg","png","gif","svg","pdf","doc","docx","key","ppt","odt","xls","xlsx","zip","rar","mp3","m4a","ogg","wav","mp4","mov","wmv","avi","mpg","ogv","3gp","3g2","mkv","txt","ico","exe","csv","java","js","xml","unx","ttf","font","css"],O={id:"",img:"",username:"",email:""},j=m(9999999,99999999),S,E=!1,P=!1,C=!1,T,N=!1,A=999999,M=!0,I=!0,D=!0,z=!1,L=!1,F=!1,W=!1,R=!1,H=!1,q=!1,Q=!1,U=!1,B=!1,Y=!1,G=!0,V=!0,$,J,X,Z,K,ee,te=!1,ie="",ne=0,oe=0,re=!1,se=!1;e(document).ready(function(){if(X=e("#sb-main"),S=e("body"),autosize(e(".sb-editor textarea")),ne=window.innerHeight,oe=window.innerWidth,re=localStorage.getItem("chat_close"),v(re)&&(re=!1),e(X).hasClass("sb-php")&&(te=!0),te?(Z=e("#sb-php-init").attr("src"),ie=Z,Z=Z.substr(0,Z.lastIndexOf("/php")),K=Z+"/php/core.php",ie=ie.indexOf("lang=")>0?ie.substr(ie.indexOf("lang=")+5):"",ee=K):(Z=sb_plugin_url_wp,K=sb_ajax_url,ee=Z+"/include/ajax.php",ie=e(X).data("language")),e(".sb-chat-cnt").length&&(E=!0),e("#sb-audio").length&&(T=e("#sb-audio")[0],C=!0),v(e(X).attr("data-welcome"))||(F=!0),v(e(X).attr("data-follow"))||(H=!0),v(e(X).attr("data-slack"))||(Q=!0),J=v(e(X).attr("data-flash"))?"New message received":e(X).attr("data-flash"),e(X).hasClass("sb-push")&&("granted"==Push.Permission.get()?U=!0:Push.Permission.request(function(){U=!0},function(){})),e(X).hasClass("sb-flash")&&(Y=!0),e(X).hasClass("welcome-always")&&(R=!0),e("body.admin-bar").length&&(q=!0),e(X).css("display",""),e("body").on("hover",X,function(){clearInterval($)}),e("body").on("click",".sb-register-link div",function(){e(".sb-login").removeClass("active"),e(".sb-register").addClass("active"),e(".sb-error-msg").hide()}),e("body").on("click",".sb-login-link div",function(){e(".sb-login").addClass("active"),e(".sb-register").removeClass("active"),e(".sb-error-msg").hide()}),e("body").on("click",".sb-submit-login",function(){var t=e(".sb-input-user input").val(),i=e(".sb-input-psw input").val();""!=t&&""!=i&&jQuery.ajax({method:"POST",url:K,data:{action:"sb_ajax_login",user:t,password:i},async:!1}).done(function(t){if("success"==t){e(".sb-error-msg").hide();var i=window.location.href;i=i.replace("&logout=true","").replace("?logout=true","").replace("&login=true","").replace("?login=true",""),i.indexOf("?")>0?window.location.href=i+"&login=true":window.location.href=i+"?login=true"}else e(".sb-error-msg").show()})}),e("body").on("click",".sb-logout",function(){jQuery.ajax({method:"POST",url:K,data:{action:"sb_ajax_logout"}}).done(function(e){if("success"==e){var t=window.location.href;t=t.replace("&logout=true","").replace("?logout=true","").replace("&login=true","").replace("?login=true",""),t.indexOf("?")>0?window.location.href=t+"&logout=true":window.location.href=t+"?logout=true"}})}),e("body").on("click",".sb-submit-register",function(){var t=e(".sb-input-reg-user input").val(),i=e(".sb-input-reg-psw input").val(),n,o=e(".sb-error-msg-reg"),r=e(o).attr("data-messages").split("|");if("email"==e(".sb-input-reg-user input").attr("type"))n=t;else{var s=e(".sb-email  input");n=s.length?e(s).val():"--"}if(""!=t&&""!=i&&"--"!=n&&(n.indexOf("@")<1||n.indexOf(".")<1)?(e(o).html(r[3]).show(),n=""):e(o).hide(),t.indexOf("'")>0||t.indexOf('"')>0?(e(o).html(r[4]).show(),t=""):e(o).hide(),""!=t&&""!=i&&(""!=n||"--"==n))if(i.length>3)if(i==e(".sb-input-reg-psw-2  input").val()){var a=e(".sb-extra-1  input").val(),c=e(".sb-extra-2  input").val(),l=e(".sb-extra-3  input").val(),u=e(".sb-extra-4  input").val(),d=e(".sb-input-reg-img img").attr("src");v(n)&&(n=""),v(a)&&(a=""),v(c)&&(c=""),v(l)&&(l=""),v(u)&&(u=""),v(d)&&(d=Z+"/media/user-2.jpg"),jQuery.ajax({method:"POST",url:K,data:{action:"sb_ajax_register",id:j,img:d,username:p(t),psw:i,email:n,extra1:a,extra2:c,extra3:l,extra4:u}}).done(function(t){"success"==t&&(e(".sb-login .sb-success-registration").show(),e(".sb-login-link div").click()),"error-user-double"==t&&e(o).html(r[2]).show()})}else e(o).html(r[0]).show();else e(o).html(r[1]).show()}),e("body").on("click",".sb-input-reg-img",function(){e(".sb-upload-profile-img").click()}),e(".sb-upload-profile-img").change(function(t){var i=e(this).prop("files");v(i)&&(i=""),(i[0].name.indexOf(".jpg")>0||i[0].name.indexOf(".png")>0)&&n(i)}),O=localStorage.getItem("sb_guest_user"),!v(e(X).data("privacy"))&&"approved"!=localStorage.getItem("sb_privacy")){se=!0;var i=e(X).data("privacy-btn-approve"),o=e(X).data("privacy-btn-decline");v(i)&&(i="Yes, I Accept"),v(o)&&(o="No, Not Now"),e(".sb-editor").hide(),e(".sb-chat-list,.sb-list").append('<div class="privacy-msg"><p>'+e(X).data("privacy")+'</p><div><a class="sb-approve">'+i+"</a><a>"+o+"</a></div></div>")}if(v(O)){var l=m(9999,999999);O={id:"guest-"+l,img:Z+"/media/user-2.jpg",username:"Guest "+l,email:""},e(".sb-title span").html("Guest "+l),L=!0,z=!0}else O=JSON.parse(O);jQuery.ajax({method:"POST",url:K,data:{action:"sb_ajax_init_user",user_id:O.id,user_img:O.img,user_name:O.username,user_email:O.email}}).done(function(t){"success"!=t&&(O=JSON.parse(t),L&&localStorage.setItem("sb_guest_user",JSON.stringify(O)),z=!0),e(".sb-list,.sb-chat-list").each(function(){var t=this;if(!v(e(t).attr("data-scroll"))||E){var i=e(t).attr("data-height"),n=parseInt(e(t).attr("data-offset"));E&&(i=300),v(n)&&(n=0),q&&(n+=32),i="fullscreen"==i?ne-n:parseInt(i),i>200&&setTimeout(function(){var n=e(".sb-chat");N=!0;var o=e(n).height();E&&ne<o+250&&(e(".sb-chat-cnt").addClass("sb-active-hidden"),i=ne-e(".sb-chat-header").outerHeight()-160,e(".sb-chat-cnt").removeClass("sb-active-hidden"),oe>767&&(i-=100),e(n).addClass("sb-chat-custom-height"),i>400&&(i=400));var r=e(t).attr("data-options"),s,a={height:i,size:"4px",color:"#AAB2BA",start:"bottom",allowPageScroll:!E};v(r)||(s=r.split(","),a=y(r,a)),e(t).slimScroll(a)},300)}else e(".sb-card").length&&e("body").animate({scrollTop:e(".sb-card").last().offset().top},1);se||a(t,E),E||P||(setInterval(function(){G&&!se&&a(e(".sb-list"))},5e3),P=!0)})}),e("body").on("click",".privacy-msg > div > a",function(){if(e(this).hasClass("sb-approve"))se=!1,a(e(".sb-list,.sb-chat-list"),E),e(".privacy-msg").remove(),e(".sb-editor").show(),localStorage.setItem("sb_privacy","approved");else{var t=e(X).data("privacy-msg-decline");v(t)&&(t="Okay, no problem! We completely understand. You can accept the consent request any time."),e(".privacy-msg > p").html(t)}}),e("body").on("click",".sb-editor .sb-submit",function(){var i=e(this).closest(".sb-editor").find(".sb-upload-files").prop("files");v(i)&&(i=""),S=e(this).closest(".sb-cnt-global"),L?(jQuery.ajax({method:"POST",url:K,data:{action:"sb_ajax_register",id:O.id,img:O.img,username:O.username,psw:"123456",email:""}}).done(function(n){i.length>0?(t(i),e(".sb-clear-msg").hide()):r()}),L=!1):i.length>0?(t(i),e(".sb-clear-msg").hide()):r(),G=!1,P||(setInterval(function(){G&&!se&&a(e(".sb-chat-list,.sb-list"))},5e3),P=!0),e(".sb-list-msg").hide()}),e("body").on("click",".sb-clear-msg",function(){e(".sb-editor .sb-upload-files").replaceWith(e(".sb-editor .sb-upload-files").val("").clone(!0)),e(".sb-attachment-cnt .sb-attachments-list").html(""),e(".sb-clear-msg").hide()}),E&&(e("body").on("click",".sb-chat-btn",function(){var t=e(".sb-chat-cnt");e(t).hasClass("sb-active")?(e(t).removeClass("sb-active"),x(!0)):(e(t).addClass("sb-active"),P||(setInterval(function(){G&&!se&&a(e(".sb-chat-list"))},5e3),P=!0))}),e(".sb-chat .sb-editor textarea").on("keydown",function(t){13==t.which&&(e(".sb-chat .sb-submit").click(),t.preventDefault)})),e("body").on("click",".sb-btn-email",function(){var t=e(this).closest(".sb-card-cnt"),i=e(t).find("input").val();""!=i&&(e(t).find(".sb-error-msg").hide(),i.indexOf("@")>0&&i.indexOf(".")>0?jQuery.ajax({method:"POST",url:K,data:{action:"sb_ajax_update_user",id:O.id,email:i}}).done(function(i){"success"==i&&e(t).html(e(t).find(".sb-success-msg").html()).addClass("sb-success-msg")}):e(t).find(".sb-error-msg").show())}),e("body").on("click",".sb-attachment",function(){e(this).closest(".sb-editor").find(".sb-upload-files").click()}),e(".sb-upload-files").change(function(t){for(var i="",n=!1,o=t.currentTarget.files.length,r=0;r<o;r++)i+='<div class="sb-attachment-item">'+t.currentTarget.files[r].name+"</div>";e(this).closest(".sb-editor").find(".sb-attachment-cnt .sb-attachments-list").html(i),e(".sb-clear-msg").show()}),e("body").on("click",".rich-quickreplies .rich-content > div,.rich-buttons .rich-content > div",function(){var t=e(this).index(),i=e(this).closest(".rich-box"),n="";e(i).hasClass("rich-closed")||(e(i).addClass("rich-closed"),(e(i).hasClass("rich-quickreplies")||e(i).hasClass("rich-buttons"))&&(n=e(this).html(),e(i).find(".rich-content").html("<div>"+n+"</div>")),jQuery.ajax({method:"POST",url:ee,data:{action:"sb_ajax_update_message",msg_action:"rich",index:e(i).closest(".sb-card").index(),content:t,user_id:O.id}}).done(function(e){s(n),c(n)}))})});var ae=function(){var e,t,i={hidden:"visibilitychange",webkitHidden:"webkitvisibilitychange",mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange"};for(e in i)if(e in document){t=i[e];break}return function(i){return i&&document.addEventListener(t,i),!document[e]}}();ae(function(){ae()?(V=!0,clearInterval($)):V=!1})}(jQuery);